Working file 3 created in upstream master
Difficult problem in this file
Here is the starting point

Second attempt
step A, step A's popular memory leak issue.
step B
step C, step C's low gradient triangle issue.
step 2
